# Gemini CLI æ ¸å¿ƒè¡Œç‚ºæº–å‰‡ (Core Guidelines)

æœ¬æª”æ¡ˆå®šç¾©äº† Gemini CLI çš„æ ¸å¿ƒæ“ä½œè¦ç¯„ã€æž¶æ§‹åå¥½èˆ‡æŠ€è¡“æœ€ä½³å¯¦è¸ã€‚æ­¤æº–å‰‡é©ç”¨æ–¼æ‰€æœ‰ Android/Kotlin å°ˆæ¡ˆé–‹ç™¼ï¼Œæ—¨åœ¨ç¢ºä¿ä»£ç¢¼å“è³ªã€ä¸€è‡´æ€§èˆ‡ä½¿ç”¨è€…é«”é©—ã€‚

---

### **ç¬¬ä¸€ç« ï¼šäº’å‹•å”è­° (Interaction Protocol)**

*   **æºé€šèªžè¨€**: é è¨­ä½¿ç”¨ **ç¹é«”ä¸­æ–‡ (Traditional Chinese)**ã€‚
*   **è‡ªä¸»åŸ·è¡Œ (Autonomous Execution)**: å°æ–¼å¤šæ­¥é©Ÿä»»å‹™ï¼Œæ‡‰è‡ªå‹•é€£çºŒåŸ·è¡Œï¼Œåƒ…åœ¨é‡åˆ°è‡´å‘½éŒ¯èª¤æˆ–éœ€äººå·¥æ±ºç­–æ™‚æš«åœã€‚
---

### **ç¬¬äºŒç« ï¼šå·¥ä½œæ–¹æ³•è«– (Working Methodology)**

#### **Â§1 ä»£ç¢¼å®Œæ•´æ€§ (Code Integrity)**
*   **å°Šé‡ç¾ç‹€**: ä¿®æ”¹å‰å¿…é ˆç†è§£æ—¢æœ‰é‚è¼¯ã€‚
*   **å„ªå…ˆé †åº**: **å¯è®€æ€§** > **ç¶­è­·æ€§** > **æ•ˆèƒ½**ã€‚
*   **åŽŸå­åŒ–æäº¤ (Atomic Commits)**: 
    *   å°‡è®Šæ›´åˆ†è§£ç‚ºæœ€å°é‚è¼¯å–®å…ƒã€‚
    *   Commit Message éµå¾ª Conventional Commits (e.g., `feat:`, `fix:`, `chore:`).

#### **Â§2 å¢žé‡äº¤ä»˜ (Incremental Delivery)**
*   é¿å…ä¸€æ¬¡æ€§æäº¤æ•¸ç™¾è¡Œçš„å·¨å¤§è®Šæ›´ã€‚
*   æ¯å€‹éšŽæ®µæ€§æˆæžœï¼ˆå¦‚ï¼šå®Œæˆ UI ä½ˆå±€ã€å®Œæˆè³‡æ–™å±¤é€£æŽ¥ï¼‰éƒ½æ‡‰å¯è¢«ç¨ç«‹é©—è­‰ã€‚

---

### **ç¬¬ä¸‰ç« ï¼šé€šç”¨æž¶æ§‹è¦ç¯„ (Universal Architecture Standards)**

æœ¬è¦ç¯„åŸºæ–¼ **Clean Architecture** èˆ‡ **Modularization** åŽŸå‰‡ï¼Œæ—¨åœ¨å¯¦ç¾é«˜å…§èšã€ä½Žè€¦åˆçš„ç³»çµ±è¨­è¨ˆã€‚

#### **Â§1 åˆ†å±¤æž¶æ§‹èˆ‡è·è²¬ (Layered Architecture & Responsibilities)**

1.  **Domain Layer** (Business Logic):
    *   **å®šä½**: æ ¸å¿ƒæ¥­å‹™å±¤ï¼Œç´” Kotlin æ¨¡çµ„ï¼Œ**åš´ç¦**ä¾è³´ Android SDKã€‚
    *   **è·è²¬**: 
        *   å®šç¾© `UseCase` (æ¥­å‹™è¦å‰‡)ã€‚å‘½åæ…£ä¾‹: `Verb` + `Noun` + `UseCase` (e.g., `ScanLocalMusicUseCase`)ã€‚
        *   å®šç¾© `Repository` ä»‹é¢ (æ•¸æ“šåˆç´„)ã€‚
        *   å®šç¾© `Model` (æ ¸å¿ƒæ•¸æ“šæ¨¡åž‹)ã€‚
2.  **Data Layer** (Data Access):
    *   **å®šä½**: æ•¸æ“šå¯¦ä½œå±¤ï¼Œå–®ä¸€æ•¸æ“šä¾†æº (Single Source of Truth, SSOT)ã€‚
    *   **è·è²¬**:
        *   **Repository Implementation**: å¯¦ä½œ Domain å±¤ä»‹é¢ï¼Œå”èª¿æ•¸æ“šä¾†æºã€‚
        *   **Data Sources**: ç®¡ç† Database (Room), Network (Retrofit), File System, DataStoreã€‚
    *   **ä¾è³´**: åƒ…ä¾è³´ `Domain` å±¤ã€‚**åš´ç¦**è¢« `UI` å±¤ç›´æŽ¥å­˜å–ã€‚
3.  **UI Layer** (Presentation):
    *   **å®šä½**: å±•ç¤ºå±¤ï¼ŒæŽ¡ç”¨ **MVVM** (Model-View-ViewModel) æž¶æ§‹ã€‚
    *   **è·è²¬**:
        *   **Passive View**: UI (Composables) åƒ…è² è²¬æ¸²æŸ“ç‹€æ…‹èˆ‡æŽ¥æ”¶è¼¸å…¥ï¼Œä¸å«æ¥­å‹™é‚è¼¯ã€‚
        *   **ViewModel**: æŒæœ‰ `UiState` (StateFlow)ï¼Œé€éŽ `UseCase` åŸ·è¡Œé‚è¼¯ï¼Œå°‡çµæžœè½‰æ›ç‚º UI ç‹€æ…‹ã€‚
    *   **ä¾è³´**: ä¾è³´ `Domain` å±¤èˆ‡ UI Design Systemã€‚**åš´ç¦**ç›´æŽ¥ä½¿ç”¨ `Data` å±¤é¡žåˆ¥ã€‚

#### **Â§2 æ•¸æ“šæµå‘ (Data Flow: UDF)**
*   **Unidirectional Data Flow (å–®å‘æ•¸æ“šæµ)**:
    *   **State Down**: `ViewModel` -> `UiState (StateFlow)` -> `Compose UI`
    *   **Event Up**: `Compose UI (User Action)` -> `ViewModel (Function Call)` -> `Domain (UseCase)`
*   **Dependency Rule**: `UI -> Domain <- Data`

---

### **ç¬¬å››ç« ï¼šæŠ€è¡“æœ€ä½³å¯¦è¸ (Technical Excellence)**

æœ¬ç« ç¯€ç¸½çµäº†è·¨å°ˆæ¡ˆé€šç”¨çš„æŠ€è¡“é™·é˜±èˆ‡è§£æ±ºæ–¹æ¡ˆï¼Œ**å¿…é ˆ**åœ¨è¨­è¨ˆéšŽæ®µç´å…¥è€ƒé‡ã€‚

#### **Â§1 ç‹€æ…‹éŸŒæ€§ (State Resilience)**
*   **Process Death é˜²è­·**: æ‰€æœ‰é—œéµ UI ç‹€æ…‹ï¼ˆå°¤å…¶æ˜¯ **Bottom Sheets**, **Expanded Views**, **Complex Navigation State**ï¼‰**å¿…é ˆ**ä½¿ç”¨ `rememberSaveable` è€Œéž `remember`ã€‚å°æ–¼ ViewModel å±¤ç´šçš„ç‹€æ…‹ï¼Œ**å¿…é ˆ**ä½¿ç”¨ `SavedStateHandle` é€²è¡ŒæŒä¹…åŒ–ï¼Œç¢ºä¿æ‡‰ç”¨åœ¨å¾Œå°è¢«ç³»çµ±å›žæ”¶å¾Œï¼Œç”¨æˆ¶è¿”å›žæ™‚èƒ½çœ‹åˆ°ä¸€è‡´çš„ç•«é¢ï¼ˆå¦‚æŽ’åºé¸é …ã€é¸å–æ¨¡å¼ï¼‰ã€‚
*   **å‹•æ…‹ä½ˆå±€é©é…**: å°æ–¼ä¾è³´å®¹å™¨å°ºå¯¸è¨ˆç®—çš„ç‹€æ…‹ï¼ˆå¦‚ `AnchoredDraggableState` çš„ anchorsï¼‰ï¼Œæ‡‰åœ¨ `LaunchedEffect` æˆ– `onSizeChanged` ä¸­æ›´æ–°é…ç½®ï¼Œ**åš´ç¦**å› å°ºå¯¸è®ŠåŒ–è€Œé‡æ–°å‰µå»º (Re-create) ç‹€æ…‹ç‰©ä»¶ï¼Œé€™æœƒå°Žè‡´äº’å‹•ä¸­æ–·æˆ–ç‹€æ…‹é‡ç½®ã€‚

#### **Â§2 æ¥µè‡´ä½¿ç”¨è€…é«”é©— (UX Excellence)**
*   **æ™ºæ…§åˆ—è¡¨å®šä½ (Smart List Positioning)**: 
    *   ç•¶é€²å…¥ä¸€å€‹é•·åˆ—è¡¨ä¸”æœ‰æ˜Žç¢ºã€Œæ´»èºé …ç›®ã€æ™‚ï¼Œæ‡‰è‡ªå‹•æ»¾å‹•è‡³è©²é …ç›® (Auto-scroll to active item)ã€‚
*   **å®¹éŒ¯äº’å‹•è¨­è¨ˆ (Forgiving Interactions)**:
    *   **æ‰‹å‹¢å°Žèˆª**: è‡ªå®šç¾©æ»‘å‹•æŽ§ä»¶ï¼ˆå¦‚å´é‚Šç´¢å¼•æ¬„ï¼‰æ‡‰å…·å‚™ã€Œå¸é™„ã€æˆ–ã€Œæ™ºæ…§æŸ¥æ‰¾ã€åŠŸèƒ½ã€‚è‹¥ç”¨æˆ¶æ‰‹æŒ‡æ»‘åˆ°ç„¡æ•ˆå€åŸŸï¼Œæ‡‰è‡ªå‹•å®šä½è‡³æœ€è¿‘çš„æœ‰æ•ˆå…§å®¹ï¼Œè€Œéžç„¡åæ‡‰ã€‚
    *   **è¦–è¦ºåé¥‹**: ä»»ä½•æ‹–å‹•ã€é•·æŒ‰æ“ä½œéƒ½å¿…é ˆæä¾›å³æ™‚çš„è¦–è¦ºæç¤ºï¼ˆå¦‚æ°£æ³¡ã€é«˜äº®ã€éœ‡å‹•å›žé¥‹ï¼‰ã€‚
*   **æ²‰æµ¸å¼è¨­è¨ˆ (Immersive Design)**:
    *   **å…¨å±æ¨¡ç³Š**: æ’­æ”¾ä»‹é¢ (`NowPlayingScreen`) æ‡‰ä½¿ç”¨å°ˆè¼¯å°é¢çš„å…¨å±æ¨¡ç³Šä½œç‚ºèƒŒæ™¯ï¼Œä¸¦ç–ŠåŠ å‹•æ…‹æ¼¸è®Šï¼Œå‰µé€ æ·±åº¦æ„Ÿèˆ‡æ°›åœæ„Ÿã€‚
    *   **çŽ»ç’ƒæ“¬æ…‹ (Glassmorphism)**: æŽ§ä»¶å±¤èˆ‡æµ®å‹•é¢æ¿æ‡‰æŽ¡ç”¨åŠé€æ˜Žè¦–æ•ˆ (Glassmorphism)ï¼Œä»¥å€åˆ†å±¤ç´šä¸¦ä¿æŒèƒŒæ™¯çš„å¯è¦‹æ€§ã€‚
*   **èª å¯¦ UI (Honest UI)**: 
    *   è‹¥æŸ UI å…ƒç´ çœ‹ä¼¼å¯äº’å‹•ï¼ˆå¦‚ Drag Handleï¼‰ï¼Œå‰‡å¿…é ˆå…·å‚™ç›¸æ‡‰åŠŸèƒ½ã€‚è‹¥åŠŸèƒ½æœªå¯¦ä½œï¼Œæ‡‰éš±è—è©²å…ƒç´ æˆ–æ›¿æ›ç‚ºè³‡è¨Šæ€§çµ„ä»¶ï¼ˆå¦‚ Metadata æ¨™ç±¤ï¼‰ï¼Œé¿å…æ¬ºé¨™ç”¨æˆ¶é æœŸã€‚
*   **é‚Šç•Œèˆ‡ç©ºç‹€æ…‹è™•ç† (Edge Cases & Empty States)**:
    *   **å…§å®¹å¡«å…… (Content Padding)**: æ‰€æœ‰æ»¾å‹•åˆ—è¡¨ï¼ˆ`LazyColumn`/`LazyGrid`ï¼‰**å¿…é ˆ**è¨­ç½®è¶³å¤ çš„ `contentPadding` (bottom)ï¼Œä»¥é¿é–‹æ‡¸æµ®çµ„ä»¶ï¼ˆå¦‚ MiniPlayer, FABï¼‰ã€‚é¿å…å…§å®¹è¢«é®æ“‹ç„¡æ³•è§¸åŠã€‚
    *   **å„ªé›…å¤±æ•— (Graceful Failure)**: åœ–ç‰‡åŠ è¼‰å¤±æ•—æ™‚ï¼Œ**å¿…é ˆ**é¡¯ç¤ºä½”ä½ç¬¦ (Placeholder) æˆ–åœ–æ¨™ (Icon)ï¼Œåš´ç¦ç•™ç™½ã€‚å°æ–¼å‹•æ…‹ä¸»é¡Œ (Dynamic Theme)ï¼Œè‹¥åœ–ç‰‡åŠ è¼‰å¤±æ•—ï¼Œæ‡‰å›žé€€è‡³é è¨­æˆ–ä¸­æ€§è‰²ã€‚
    *   **è¼¸å…¥é˜²å‘†**: é—œéµè¼¸å…¥ï¼ˆå¦‚å‰µå»ºæ’­æ”¾æ¸…å–®ï¼‰**å¿…é ˆ**åœ¨ UI å±¤ç´šï¼ˆå¦‚æŒ‰éˆ• `enabled` ç‹€æ…‹ï¼‰å³æ™‚åæ‡‰æœ‰æ•ˆæ€§ï¼Œé˜²æ­¢ç„¡æ•ˆæäº¤ã€‚
    *   **ç©ºç‹€æ…‹åé¥‹**: ç„¡æ•¸æ“šæ™‚ï¼ˆå¦‚ç©ºæ’­æ”¾æ¸…å–®ã€ç„¡æœå°‹çµæžœï¼‰ï¼Œæ‡‰é¡¯ç¤ºæ˜Žç¢ºçš„åœ–ç¤ºèˆ‡å¼•å°Žæ–‡å­—ï¼Œè€Œéžç©ºç™½ç•«é¢ã€‚

#### **Â§3 æŽ¢ç´¢èˆ‡å°Žèˆªå„ªåŒ– (Discovery & Navigation)**
*   **å„€è¡¨æ¿ä½ˆå±€ (Dashboard Layout)**:
    *   åœ¨ä¸»é é¢ (`HomeScreen`) é ‚éƒ¨æ‡‰æä¾›é«˜åƒ¹å€¼çš„æ¦‚è¦½è³‡è¨Šï¼Œå¦‚ã€Œå•å€™èªž (Greeting)ã€çµåˆã€Œå‹•æ…‹èƒŒæ™¯ã€ï¼Œä»¥åŠã€Œæœ€è¿‘æ–°å¢ž (Recently Added)ã€çš„æ©«å‘æ²å‹•åˆ—ã€‚é€™èƒ½è®“ç”¨æˆ¶ä¸€é€²å…¥ App å°±æ„Ÿå—åˆ°å…§å®¹çš„è±å¯Œæ€§ã€‚
*   **å¿«é€ŸéŽæ¿¾ (Quick Access Filters)**:
    *   åœ¨åˆ—è¡¨æŽ§åˆ¶åˆ— (`ControlRow`) æä¾›é«˜é »çŽ‡ä½¿ç”¨çš„éŽæ¿¾å™¨ï¼ˆå¦‚ã€Œåƒ…é¡¯ç¤ºæœ€æ„› (Favorites Only)ã€ï¼‰ã€‚é€™æ¯”é€²å…¥æ·±å±¤é¸å–®æ›´èƒ½æå‡æ—¥å¸¸ä½¿ç”¨é«”é©—ã€‚
*   **åç§»æ„ŸçŸ¥æ²å‹• (Offset-Aware Scrolling)**:
    *   ç•¶åˆ—è¡¨åŒ…å« Headerï¼ˆå¦‚å„€è¡¨æ¿ã€å»£å‘Šã€æœå°‹åˆ—ï¼‰æ™‚ï¼Œ`FastScroller` æˆ–é¡žä¼¼çš„è·³è½‰é‚è¼¯å¿…é ˆåŠ ä¸Š `headerOffset`ï¼Œç¢ºä¿è·³è½‰å¾Œçš„å®šä½ç²¾æº–å°é½Šåˆ—è¡¨é …ï¼Œè€Œéž Headerã€‚

#### **Â§4 ç³»çµ±å…¼å®¹æ€§èˆ‡é™¤éŒ¯ (System Compatibility & Debugging)**
*   **æ¬Šé™ç­–ç•¥ (Permission Strategy)**: 
    *   é‡å° Android 13+ (API 33+) çš„ `POST_NOTIFICATIONS` èˆ‡ç´°åˆ†åª’é«”æ¬Šé™ (`READ_MEDIA_AUDIO` ç­‰)ï¼Œ**å¿…é ˆ**åœ¨ç›¸é—œåŠŸèƒ½å•Ÿå‹•å‰ (å¦‚ `MainActivity.onCreate` æˆ–æ’­æ”¾å‰) é€²è¡Œæª¢æŸ¥èˆ‡è«‹æ±‚ã€‚æ°¸é ä¸è¦å‡è¨­æ¬Šé™å·²è¢«æŽˆäºˆã€‚
*   **Release æ¨¡å¼é©—è­‰ (Verifying in Release Mode)**:
    *   Jetpack Compose åœ¨ Debug æ¨¡å¼ä¸‹æœƒæœ‰é¡¯è‘—çš„æ•ˆèƒ½é–‹éŠ·ï¼ˆå°¤å…¶æ˜¯ 120Hz æ»¾å‹•ï¼‰ã€‚é‡åˆ°ã€Œå¡é “ã€å•é¡Œæ™‚ï¼Œ**å„ªå…ˆ**æª¢æŸ¥ Release Build æ˜¯å¦æ­£å¸¸ï¼Œé¿å…åœ¨ Debug æ¨¡å¼ä¸‹éŽæ—©å„ªåŒ–ã€‚

#### **Â§5 æ•ˆèƒ½å„ªåŒ– (Performance Optimization)**
*   **å¾Œå°ç·šç¨‹å„ªå…ˆ (Background Thread First)**:
    *   æ‰€æœ‰è³‡æ–™è™•ç†ï¼ˆå¦‚ `combine`, `map`, `filter`, `sortedBy`ï¼‰è‹¥æ¶‰åŠå¤§é‡æ•¸æ“šï¼Œ**å¿…é ˆ**é€éŽ `.flowOn(Dispatchers.Default)` ç§»è‡³å¾Œå°ç·šç¨‹åŸ·è¡Œï¼Œåš´ç¦é˜»å¡ž UI ç·šç¨‹ã€‚
*   **ç‹€æ…‹ç©©å®šæ€§ (State Stability)**:
    *   æ‰€æœ‰ UI State é¡žåˆ¥ï¼ˆç‰¹åˆ¥æ˜¯åŒ…å« `List` çš„ï¼‰**å¿…é ˆ**æ¨™è¨» `@Immutable` æˆ– `@Stable`ã€‚é€™èƒ½å•Ÿç”¨ Compose çš„æ™ºæ…§é‡çµ„è·³éŽæ©Ÿåˆ¶ (Smart Recomposition Skipping)ã€‚
*   **ä½ˆå±€ç©©å®šæ€§ (Layout Stability)**:
    *   **å›ºå®šé«˜åº¦å„ªå…ˆ**: åœ¨è¤‡é›œåˆ—è¡¨ (`LazyColumn`) ä¸­ï¼Œå¦‚æžœå¯èƒ½ï¼Œ**å¼·åˆ¶è¨­å®šé …ç›®ç‚ºå›ºå®šé«˜åº¦** (e.g., `Modifier.height(72.dp)`)ã€‚é€™èƒ½å¤§å¹…æ¸›å°‘æ¸¬é‡é–‹éŠ·ä¸¦æ¶ˆé™¤æ»¾å‹•æŠ–å‹• (Scroll Jitter)ã€‚
*   **è¼•é‡åŒ–æ¸²æŸ“ (Lightweight Rendering)**:
    *   **ç§»é™¤ Heavy Wrappers**: é¿å…åœ¨åˆ—è¡¨é …ä¸­ä½¿ç”¨é«˜é–‹éŠ·å®¹å™¨ï¼ˆå¦‚ `Card`ï¼‰ï¼Œæ”¹ç”¨è¼•é‡ç´š Modifierï¼ˆå¦‚ `Modifier.clip()`, `Modifier.border()`ï¼‰ã€‚
    *   **åœ–ç‰‡è¼‰å…¥å„ªåŒ–**: ä½¿ç”¨ Coil æ™‚ï¼Œ**å¿…é ˆ**æŒ‡å®š `.size()` (è¼‰å…¥ç¸®åœ–)ã€`.memoryCacheKey()` ä¸¦æ˜Žç¢ºæŒ‡å®š `Dispatchers.IO`ï¼Œé¿å…ä¸»ç·šç¨‹é˜»å¡žã€‚
    *   **Callback ç©©å®šåŒ–**: å‚³éžçµ¦å­çµ„ä»¶çš„ Lambdaï¼Œè‹¥ä¾è³´å¤–éƒ¨ç‹€æ…‹ï¼Œæ‡‰ä½¿ç”¨ `rememberUpdatedState` åŒ…è£æˆ–å„ªåŒ–ç‚ºæ–¹æ³•å¼•ç”¨ï¼Œé¿å…å°Žè‡´å­çµ„ä»¶ç„¡æ•ˆé‡çµ„ã€‚
    *   **æœå°‹è¼¸å…¥é˜²æŠ– (Search Debounce)**:
        *   é‡å°æœ¬åœ°æœå°‹ (Local Search) æˆ–é »ç¹éŽæ¿¾æ“ä½œï¼Œ**å¿…é ˆ**å¯¦ä½œ Debounce (å»ºè­° 300ms) ä¸¦é…åˆ `.flowOn(Dispatchers.Default)`ã€‚é€™èƒ½é¿å…æ¯æ¬¡æŒ‰éµéƒ½è§¸ç™¼é‡è¨ˆç®—ï¼Œå°Žè‡´è¼¸å…¥å¡é “ã€‚
    *   **å°Žèˆªè§£è€¦ (Decoupled Navigation)**:
        *   æ·±å±¤çµ„ä»¶ (å¦‚ `NowPlayingScreen`) ä¸æ‡‰æŒæœ‰ `NavController`ã€‚æ‡‰é€éŽ Lambda å›žèª¿ (e.g. `onAlbumClick: (Long) -> Unit`) å°‡å°Žèˆªäº‹ä»¶å‘å¤–å‚³éžçµ¦é ‚å±¤ NavHost è™•ç†ã€‚é€™èƒ½ä¿æŒçµ„ä»¶ç´”æ·¨ä¸”æ˜“æ–¼æ¸¬è©¦ã€‚

---

### **ç¬¬äº”ç« ï¼šAgent æ“ä½œè¦ç¯„ (Agent Operations)**

*   **ç„¡è¼¸å‡ºè™•ç† (No Output Handling)**: 
    *   ç•¶ç™¼ç¾ `run_command` æ²’æœ‰é æœŸè¼¸å‡ºæ™‚ï¼Œ**å¼·åˆ¶**æ”¹ç”¨ `run_command` å•Ÿå‹•ä¸€å€‹æŒçºŒçš„ Shell Session (å¦‚ `cmd`)ï¼ŒæŽ¥è‘—ä½¿ç”¨ `send_command_input` ç™¼é€æŒ‡ä»¤ï¼Œä»¥ç¢ºä¿èƒ½ç²å–åŸ·è¡Œçµæžœã€‚


## é …ç›®è¦åŠƒèˆ‡å„ªåŒ–æ–¹å‘ (Project Roadmap & Optimization Directions)

### 1. ç¾ç‹€åˆ†æž (Current Status Analysis)
*   **ç‰ˆæœ¬ (Version)**: v1.2.0 (é–‹ç™¼ä¸­)
*   **å„å±¤æž¶æ§‹ (Architecture)**: å°ˆæ¡ˆæŽ¡ç”¨æ¨™æº–çš„ Clean Architecture (UI -> Domain <- Data)ï¼Œè·è²¬åˆ†é›¢æ¸…æ™°ã€‚
*   **æ ¸å¿ƒåŠŸèƒ½ (Core Features)**: æœ¬åœ°éŸ³æ¨‚æ’­æ”¾ã€æœå°‹ã€æ’­æ”¾æ¸…å–®ç®¡ç†ã€æ­Œè©žé¡¯ç¤º (å«å„é¡žå‹•æ•ˆ)ã€æˆ‘çš„æœ€æ„›ç­‰åŸºç¤ŽåŠŸèƒ½å·²å®Œå‚™ã€‚
*   **UI/UX**: å…·å‚™é«˜åº¦å®¢è£½åŒ–çš„ç¾ä»£æ„Ÿä»‹é¢ (Glassmorphism, Dynamic Theme)ï¼Œè¦–è¦ºé«”é©—å„ªç§€ã€‚
*   **æŠ€è¡“å †ç–Š (Tech Stack)**: Jetpack Compose, Room, Coil, Hilt, Coroutines/Flowï¼Œç¬¦åˆç¾ä»£ Android é–‹ç™¼æ¨™æº–ã€‚

### 2. æœªä¾†åŠŸèƒ½è¦åŠƒ (Future Roadmap)

#### **çŸ­æœŸç›®æ¨™ (Short-term)** âœ… å¤§éƒ¨åˆ†å®Œæˆ
*   **å¾…æ’­æ¸…å–® (Up Next) å®Œå–„**: 
    *   âœ… å¯¦ä½œæ‹–æ›³æŽ’åº (Drag & Drop Reordering) çš„è¦–è¦ºå„ªåŒ– (å¦‚æ‹–æ›³æ™‚çš„é™°å½±èˆ‡æ”¾å¤§æ•ˆæžœ)ã€‚
    *   âœ… å¢žåŠ ã€Œå¿«é€Ÿåˆªé™¤ã€æ‰‹å‹¢ (Swipe to Remove)ã€‚
*   **éŒ¯èª¤è™•ç†å¼·åŒ– (Robust Error Handling)**:
    *   âœ… é‡å°æ­Œè©žæŠ“å–å¤±æ•—æä¾›é‡è©¦æ©Ÿåˆ¶èˆ‡ UI æç¤º (Loading/Error/Retry states)ã€‚
    *   ðŸ”² è™•ç†æª”æ¡ˆè®€å–æ¬Šé™è¢«æ’¤éŠ·çš„é‚Šç•Œæƒ…æ³ã€‚
*   ðŸ”² **å–®å…ƒæ¸¬è©¦ (Unit Testing)**: ç‚º `MusicRepository` èˆ‡æ ¸å¿ƒ ViewModel (å¦‚ `NowPlayingViewModel`) å¢žåŠ æ¸¬è©¦è¦†è“‹çŽ‡ã€‚

#### **ä¸­æœŸç›®æ¨™ (Mid-term)** âœ… å¤§éƒ¨åˆ†å®Œæˆ
*   **éŸ³æ•ˆå¼•æ“Žå¼·åŒ– (Audio Engine)**:
    *   âœ… åŠ å…¥ Bass Boost æŽ§åˆ¶ (0-100% å¼·åº¦èª¿ç¯€)ã€‚
    *   âœ… åŠ å…¥ Virtualizer (Surround) æŽ§åˆ¶ã€‚
    *   âœ… **EQ è¨­å®šæŒä¹…åŒ–**: æ‰€æœ‰ EQ è¨­å®šï¼ˆé »æ®µã€é è¨­ã€Bass Boostã€Virtualizerï¼‰åœ¨ App é‡å•Ÿå¾Œä¿æŒã€‚
    *   âœ… **Loudness Enhancer**: éŸ¿åº¦å¢žå¼·æŽ§åˆ¶ (0-10 dB)ã€‚
    *   âœ… **è‡ªå®šç¾© EQ é è¨­**: ç”¨æˆ¶å¯ä¿å­˜/è¼‰å…¥/åˆªé™¤è‡ªå·±çš„ EQ è¨­å®šçµ„ã€‚
    *   ðŸ”² æ“´å…… Equalizer è‡³ 10 æ®µèª¿ç¯€ (å—ç¡¬é«”é™åˆ¶ï¼Œè¦–è¨­å‚™æ”¯æ´æƒ…æ³)ã€‚
*   âœ… **ä¸­ç¹¼è³‡æ–™ç·¨è¼¯å™¨ (Tag Editor)**: ä½¿ç”¨ JAudioTagger å¯¦ç¾å®Œæ•´ ID3 æ¨™ç±¤ç·¨è¼¯åŠŸèƒ½ã€‚
*   âœ… **æ¡Œé¢å°å·¥å…· (App Widget)**: ä¸»ç•«é¢å¿«é€ŸæŽ§åˆ¶æ’­æ”¾çš„å°å·¥å…·å·²å¯¦ä½œã€‚
*   âœ… **Android Auto æ”¯æ´**: MediaLibrarySession å·²é…ç½®ï¼Œæ”¯æ´ç€è¦½ Recent/All Songs/Albums/Artists ç›®éŒ„ã€‚
*   âœ… **æ¬Šé™æ’¤éŠ·è™•ç†**: æ–°å¢ž PermissionRequiredScreenï¼ŒonResume æ™‚è‡ªå‹•æª¢æ¸¬æ¬Šé™æ’¤éŠ·ä¸¦é¡¯ç¤ºæç¤ºã€‚

#### **æ–°å¢žåŠŸèƒ½ (Recently Added - v1.1.x)** âœ…
*   âœ… **è†è½çµ±è¨ˆ (Listening Stats)**: å®Œæ•´çš„è†è½æ­·å²è¿½è¹¤å’Œçµ±è¨ˆåˆ†æžé é¢ã€‚
*   âœ… **æ™ºæ…§æ’­æ”¾æ¸…å–® (Smart Playlists)**: 9 ç¨®è‡ªå‹•ç”Ÿæˆçš„æ’­æ”¾æ¸…å–® (æœ€å¸¸æ’­æ”¾ã€æœ€è¿‘æ’­æ”¾ã€æœ€è¿‘æ–°å¢žã€å¾žæœªæ’­æ”¾ã€æœ€æ„›ã€é•·æ›²ã€çŸ­æ›²ã€æœ¬é€±ã€æœ¬æœˆ)ã€‚
*   âœ… **æ’­æ”¾é€Ÿåº¦æŽ§åˆ¶ (Playback Speed)**: 0.5x - 2.0x å¯èª¿æ•´æ’­æ”¾é€Ÿåº¦ã€‚
*   âœ… **éŸ³è¨Šäº¤å‰æ·¡å…¥æ·¡å‡º (Crossfade)**: æ­Œæ›²åˆ‡æ›æ™‚çš„å¹³æ»‘éŽæ¸¡æ•ˆæžœ (0-12ç§’)ã€‚
*   âœ… **ç¡çœ å®šæ™‚å™¨æ·¡å‡º (Sleep Timer Fade)**: ç¡çœ å®šæ™‚å™¨åˆ°æœŸå‰æ¼¸é€²é™ä½ŽéŸ³é‡ã€‚
*   âœ… **è³‡æ–™å¤¾ç€è¦½å™¨ (Folder Browser)**: æŒ‰è³‡æ–™å¤¾çµæ§‹ç€è¦½éŸ³æ¨‚ï¼Œæ”¯æ´éºµåŒ…å±‘å°Žèˆªã€æœå°‹ã€æŽ’åºã€‚
*   âœ… **éŸ³è¨Šè¦–è¦ºåŒ– (Audio Visualizer)**: 5 ç¨®è¦–è¦ºåŒ–æ•ˆæžœ (é »è­œæ¢ã€æ³¢å½¢ã€åœ“å½¢ã€ç·šæ¢ã€ç²’å­)ã€‚
*   âœ… **é€²éšŽç¡çœ å®šæ™‚å™¨ (Advanced Sleep Timer)**: æ”¯æ´æ™‚é–“/æ›²ç›®æ•¸/ç•¶å‰æ›²çµæŸä¸‰ç¨®æ¨¡å¼ã€‚

#### **æ–°å¢žåŠŸèƒ½ (v1.2.0 - é–‹ç™¼ä¸­)** ðŸš§
*   âœ… **æŽ¨è–¦å¼•æ“Ž (Recommendation Engine)**: åŸºæ–¼è†è½æ­·å²çš„æ™ºèƒ½éŸ³æ¨‚æŽ¨è–¦ç³»çµ±ã€‚
    *   æ¯æ—¥ç²¾é¸ (Daily Mix)
    *   è¢«éºå¿˜çš„æœ€æ„› (Forgotten Favorites)
    *   æ·±åº¦æŽ¢ç´¢ (Deep Cuts)
    *   è—äººé›»å° (Artist Radio)
    *   æ™‚æ®µæŽ¨è–¦ (Time-based Recommendations)
*   âœ… **æŽ¢ç´¢é é¢ (Discover Screen)**: å…¨æ–°çš„å€‹äººåŒ–æŽ¨è–¦ä»‹é¢ã€‚
*   âœ… **æ­Œè©žç·¨è¼¯å™¨ (Lyrics Editor)**: é›¢ç·šæ­Œè©žç·¨è¼¯ã€æ™‚é–“æˆ³èª¿æ•´ã€LRC åŒ¯å…¥/åŒ¯å‡ºã€‚
*   âœ… **æ­Œè©žåµŒå…¥/æå–**: å°‡ç·¨è¼¯å¾Œçš„æ­Œè©žåµŒå…¥åˆ°éŸ³è¨Šæª”æ¡ˆ ID3 æ¨™ç±¤ä¸­ï¼Œæˆ–å¾žæª”æ¡ˆä¸­æå–åµŒå…¥çš„æ­Œè©žã€‚
*   âœ… **Scrobbling æ•´åˆ**: 
    *   æ’­æ”¾æœå‹™è‡ªå‹•è¨˜éŒ„ Scrobbleï¼ˆç¬¦åˆ 50% æˆ– 4 åˆ†é˜æ¨™æº–ï¼‰ã€‚
    *   Last.fm API æ•´åˆæž¶æ§‹ï¼ˆèªè­‰ã€Scrobbleã€Now Playingï¼‰ã€‚
    *   å¾…åŒæ­¥ Scrobble éšŠåˆ—ç®¡ç†ã€‚
*   ðŸ”² **Last.fm å¸³æˆ¶é€£æŽ¥ UI**: è¨­å®šé é¢ä¸­æ–°å¢ž Last.fm å¸³æˆ¶é€£æŽ¥ä»‹é¢ã€‚

#### **é•·æœŸç›®æ¨™ (Long-term)**
*   **é›²ç«¯å‚™ä»½èˆ‡åŒæ­¥ (Cloud Backup)**: æ•´åˆ Google Driveï¼Œå‚™ä»½æ’­æ”¾æ¸…å–®èˆ‡æœ€æ„›æ­Œæ›²è¨­å®šã€‚
*   **è·¨å¹³å°æ”¯æ´ (Cross-platform)**: è©•ä¼°é·ç§»è‡³ Kotlin Multiplatform (KMP) çš„å¯è¡Œæ€§ (è¦–éœ€æ±‚è€Œå®š)ã€‚
*   **CarPlay-style é§•é§›æ¨¡å¼**: å¤§å­—é«”ã€ç°¡åŒ–æ“ä½œçš„é§•é§›æ¨¡å¼ UIã€‚
*   **å¤šä¸»é¡Œæ”¯æ´ (Multiple Themes)**: å¤šç¨®é è¨­ä¸»é¡Œ + è‡ªå®šç¾©ä¸»é¡Œã€‚

### 3. å„ªåŒ–æ–¹å‘ (Optimization Focus)

#### **æ•ˆèƒ½ (Performance)**
*   **æ¸²æŸ“å„ªåŒ–**: æŒçºŒç›£æŽ§ `LazyColumn` èˆ‡è¤‡é›œå‹•ç•« (å¦‚ `WaveformSeekBar`) çš„é‡çµ„æ¬¡æ•¸ï¼Œå–„ç”¨ `derivedStateOf` èˆ‡ `remember`ã€‚
*   **å•Ÿå‹•é€Ÿåº¦**: å°Žå…¥ Baseline Profiles ä»¥å„ªåŒ– Cold Start æ™‚é–“ã€‚
*   **è¨˜æ†¶é«”ç®¡ç†**: é‡å°å¤§åœ– (Album Art) çš„ Coil å¿«å–ç­–ç•¥é€²è¡Œå¾®èª¿ï¼Œé˜²æ­¢ OOMã€‚

#### **æž¶æ§‹èˆ‡è¦ç¯„ (Architecture & Standards)**
*   **Strict Domain Purity**: ç¢ºä¿ Domain å±¤å®Œå…¨ä¸ä¾è³´ Android SDK (ç›®å‰å¤§æ–¹å‘æ­£ç¢ºï¼Œéœ€æŒçºŒä¿æŒ)ã€‚
*   **MVI Pattern**: çµ±ä¸€æ‰€æœ‰ ViewModel çš„ç‹€æ…‹ç®¡ç†æ¨¡å¼ï¼Œç¢ºä¿ State Flow çš„å–®å‘æ€§ã€‚

---

## Gemini Added Memories
- User prefers Traditional Chinese (ç¹é«”ä¸­æ–‡) for interaction.
